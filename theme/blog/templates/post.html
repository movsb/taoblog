{{define "custom_header"}}
<base href="/{{.Data.Post.ID}}/">
<script>
TaoBlog.posts["{{.Data.Post.Id}}"] = {{strip .Data.Post}};
TaoBlog.post_id = +"{{.Data.Post.Id}}";
</script>
{{end -}}

{{- $dot:=. -}}
{{- render "header" . -}}
<article class="post post-{{.Data.Post.ID}}{{with .Data.Post.OriginClass}}{{.}}{{end}}" id="{{.Data.Post.Id}}">
	{{ with .Data.Post }}
	{{if not .TitleIsAutoGenerated}}
	<h1 class="title">{{.StatusString}}{{ .Title }}</h1>
	{{end}}
	<div class="entry {{ .EntryClass }}">
	{{if ne .Type "tweet"}}
	<div class="meta1">
		<a class="sitename" href="/" title="回到主页（快捷键：b）">{{ siteName }}</a>
		<span class="author">{{ authorName . }}</span>
		{{ if ne .Type `page` }}
		<time class="date" title="发表时间：{{.DateString}}
修改时间：{{.ModifiedString}}" datetime="{{.DateString}}">{{ .ShortDateString }}</time>
		{{ end }}
		{{ editLinkHTML $ }}
		{{ with .Metas.Weixin }}
			<span>在<span class="weixin"><a class="no-external" href="https://mp.weixin.qq.com/s/{{.}}" target="_blank">微信</a></span>上查看</span>
		{{ end }}
		{{ if .IsPublic }}
		<span>阅读次数：<span class="view">{{ .PageView }}</span></span>
		{{ end }}
	</div>
	{{end}}
	<div class="content{{with .Outdated}} outdated{{end}}">
		{{raw `<!--article begins here-->`}}
		{{- .Content -}}
		{{raw `<!--article ends here-->`}}
	</div>
	</div><!-- end entry -->
	{{if ne .Type "tweet"}}
	{{if .Tags}}
	<div class="meta2">
		<p><b>标签：</b><span class="value">{{.TagsString}}</span></p>
	</div>
	{{end}}
	{{ with .Relates }}
	<div class="related">
		<div class="name">相关文章</div>
		<ul>
		{{ range . }}
			<li><a href="{{.Link}}">{{.Title}}</a></li>
		{{ end }}
		</ul>
	</div><!-- end related -->
	{{ end }}
	{{else}}
	<div class="meta2">
		<span class="status">{{ .StatusString }}</span>
		<a class="sitename" href="/">{{ siteName }}</a>
		<a class="sitename" href="/tweets#{{.Id}}">{{ $.TweetName }}</a>
		<span class="author">{{ authorName . }}</span>
		{{ friendlyDateTime .Date }}
		{{- with .GeoElement }}
			{{ . }}
		{{- end }}
		{{- with .Origin }}
		<a class="origin" title="{{.Description}}" href="{{.URL}}" target="_blank">来源</a>
		{{- end }}
		{{ editLinkHTML $ }}
	</div>
	{{end}}

	{{ end }}{{/* end with post */}}
	<script>TaoBlog.comments = {{ $.Data.CommentsAsJsonArray }};</script>
</article>

{{- if $dot.ShowAsideRight }}
<aside class="right">
	{{ with $dot.Data.TOC }}
	<div class="toc">
		{{ . }}
	</div>
	{{ end }}
</aside>
{{ end }}

{{ render "footer" . }}

{{define "custom_footer"}}
{{end}}
