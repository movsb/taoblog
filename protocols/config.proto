syntax = "proto3";
package protocols;
option go_package = "github.com/movsb/taoblog/proto";

message GetConfigRequest {
	string path = 1;
}

message GetConfigResponse {
	string yaml = 1;
}

message SetConfigRequest {
	string path = 1;
	string yaml = 2;
}

message SetConfigResponse {

}

message GetInfoRequest {}

message GetInfoResponse {
	// 站点名字
	string name = 1;

	// 站点描述
	string description =  2;

	// 站点主页地址。
	// 形如：https://blog.twofei.com
	// 或者：https://blog.twofei.com/
	string home = 3;
	
	// Git 版本号
	string commit = 4;

	// 本次启动已运行时长。
	// 以 秒 为单位。
	int32 uptime = 5;

	// 最后更新时间。
	// 主要包含：文章。
	int32 last_posted_at = 10;

	// 域名证书有效时间剩余天数。大于 >= 0 有效。
	int32 cert_days_left = 11;

	// 域名有效时间剩余天数。大于 >= 0 有效。
	int32 domain_days_left = 12;
	
	// 已计划更新镜像并重启？
	bool scheduled_update = 13;

	// 上次备份时间（时间戳）。
	int32 last_backup_at = 14;

	// 上次同步时间（时间戳）。
	int32 last_sync_at = 15;
}

message RestartRequest {
	string reason = 1;
}

message RestartResponse {

}

message ScheduleUpdateRequest {}
message ScheduleUpdateResponse {}

message SiteConfig {
	// 站点名称。
	string name = 1;

	// 站点描述。
	string description = 2;

	// 站点主页地址。
	// 形如：https://blog.twofei.com
	// 暂不支持带路径。
	string home = 3;

	// 站点图标。
	// DataURL.
	string icon = 4;
}

message GetSiteConfigRequest {}
message GetSiteConfigResponse {
	SiteConfig config = 1;
}

message UpdateSiteConfigRequest {
	SiteConfig config = 1;

	// 这几个总是默认修改/有传值。
	// bool update_name = 10;
	// bool update_description = 11;
	// bool update_home = 12;

	bool update_icon = 13;
}

message UpdateSiteConfigResponse {
	SiteConfig config = 1;
}
